<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Admin - LocketGold</title>

<style>
body{
  font-family: Arial;
  background: linear-gradient(135deg,#fff0f6,#ffffff);
  padding:20px;
}

.header{
  background: linear-gradient(90deg,#ff66a3,#ffb84d);
  color:white;
  padding:18px;
  border-radius:16px;
  margin-bottom:25px;
  text-align:center;
}

.card{
  background:white;
  padding:18px;
  margin-bottom:18px;
  border-radius:18px;
  border:1px solid #ffe0ec;
  box-shadow:0 8px 25px rgba(0,0,0,0.08);
}

button{
  padding:8px 14px;
  border:none;
  border-radius:12px;
  cursor:pointer;
  margin-top:10px;
  margin-right:6px;
  font-weight:600;
}

.approve{
  background: linear-gradient(90deg,#ff66a3,#ffb84d);
  color:white;
}

.delete{
  background:#ffe6f0;
  color:#ff4d88;
}
</style>
</head>

<body>

<div class="header">
  <h2>Quản lý đơn hàng</h2>
</div>

<div id="orders"></div>

<script>
const BACKEND = "https://chumchum-backend-2.onrender.com";

function loadOrders(){
  fetch(BACKEND + "/orders")
  .then(res => res.json())
  .then(data => {
    const container = document.getElementById("orders");
    container.innerHTML = "";

    if(data.length === 0){
      container.innerHTML = "<p>Chưa có đơn nào.</p>";
      return;
    }

    data.reverse().forEach(order => {

      container.innerHTML += `
        <div class="card">
          <p><b>Mã:</b> ${order.id}</p>
          <p><b>Tên:</b> ${order.name}</p>
          <p><b>SĐT:</b> ${order.phone}</p>
          <p><b>Sản phẩm:</b> ${order.product}</p>
          <p><b>Giá:</b> ${order.price}đ</p>
          <p><b>Trạng thái:</b> ${order.status}</p>

          ${order.status === "pending" ?
            `<button class="approve" onclick="approve('${order.id}')">Duyệt</button>`
            : ""}

          <button class="delete" onclick="removeOrder('${order.id}')">Xoá</button>
        </div>
      `;
    });
  });
}

function approve(id){
  fetch(BACKEND + "/approve/" + id, {
    method: "POST"
  })
  .then(res => res.json())
  .then(data => {
    loadOrders();
  });
}

function removeOrder(id){
  fetch(BACKEND + "/delete/" + id, {
    method: "POST"
  })
  .then(res => res.json())
  .then(data => {
    loadOrders();
  });
}

loadOrders();
setInterval(loadOrders, 5000);
</script>

</body>
</html>
